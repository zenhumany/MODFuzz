import r2pipe


r2 = r2pipe.open('vmlinux')
bin_symbol_table = r2.cmdj('isj')
file = 'modfuzz.txt'
ret_list = []
func_set = []
func_set_order = []

with open(file, 'r', encoding='utf-8') as f:
    lines = f.readlines()
    for line in lines:
        if 'bitmap[count_bb]=' in line:
            ret_list.append(int(line.split('bitmap[count_bb]=')[1], 16))

for ret in ret_list:
    for sym in bin_symbol_table:
        if sym['vaddr'] < ret < sym['vaddr'] + sym['size']:
            print(sym['realname'])
            func_set_order.append(sym['realname'])
            if sym['realname'] not in func_set:
                func_set.append(sym['realname'])
