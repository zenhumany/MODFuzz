import angr
import networkx
from angrutils import *

kernel = angr.Project('C:\\Users\\amdin\\Desktop\\tmp\\vmlinux_5.7.9_compressed', use_sim_procedures=False,
                      auto_load_libs=False)
cfg = kernel.analyses.CFGFast()

# callgraph = cfg.kb.callgraph
plot_cg(cfg.kb, "call_graph", format='pdf', verbose=False)

source_node = cfg.model.get_any_node(kernel.loader.find_symbol('extract_kernel').rebased_addr)

target_node = cfg.model.get_any_node(kernel.loader.find_symbol('warn').rebased_addr)
networkx.has_path(G=cfg.graph, source=source_node, target=target_node)

paths = networkx.all_shortest_paths(G=cfg.graph, source=source_node, target=target_node)
print(paths)
